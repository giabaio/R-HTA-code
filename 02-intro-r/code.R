## ----results = 'hide'---------------------------------------------------------------------------------------------------------------------
x <- 3
z <- c(1, 3)
x + z
(x * z) / 2


## ----eval = FALSE-------------------------------------------------------------------------------------------------------------------------
# net_benefit <- qaly * 20000 - cost


## ----eval = FALSE-------------------------------------------------------------------------------------------------------------------------
# threshold <- 20000
# net_benefit <- qaly * threshold - cost


## -----------------------------------------------------------------------------------------------------------------------------------------
3 * 3 + 3

(4 - 3) / 3

2^10 - 1


## -----------------------------------------------------------------------------------------------------------------------------------------
sqrt(9)


## -----------------------------------------------------------------------------------------------------------------------------------------
"Hello world!"

'Welcome'


## -----------------------------------------------------------------------------------------------------------------------------------------
x <- 2^3


## -----------------------------------------------------------------------------------------------------------------------------------------
print(x)

x


## -----------------------------------------------------------------------------------------------------------------------------------------
x * 10

sqrt(x)


## -----------------------------------------------------------------------------------------------------------------------------------------
x1 <- 20000
x2 <- 0.2
x3 <- 1800
x4 <- x2 * x1 - x3


## -----------------------------------------------------------------------------------------------------------------------------------------
threshold <- 20000
qualy <- 0.2
cost <- 1800
net_benefit <- qualy * threshold - cost


## -----------------------------------------------------------------------------------------------------------------------------------------
NA + 1


## -----------------------------------------------------------------------------------------------------------------------------------------
2 / 0

log(0)


## -----------------------------------------------------------------------------------------------------------------------------------------
log(-1)


## ----eval = FALSE-------------------------------------------------------------------------------------------------------------------------
# library(survival)


## ----eval = FALSE-------------------------------------------------------------------------------------------------------------------------
# install.packages("BCEA")


## -----------------------------------------------------------------------------------------------------------------------------------------
c(2, 6, 3, 1)

c("Apple", "Orange", "Banana")

costA <- 12.50 # A named numeric variable with value 12.50
costB <- 25
costC <- 61.80
c(costA, costB, costC)


## -----------------------------------------------------------------------------------------------------------------------------------------
length(c(costA, costB, costC))


## -----------------------------------------------------------------------------------------------------------------------------------------
1:5

seq(from = -20, to = 30, by = 10)


## -----------------------------------------------------------------------------------------------------------------------------------------
rep(2, times = 3)

rep(1:3, times = 2)

rep(1:3, each = 2)


## -----------------------------------------------------------------------------------------------------------------------------------------
costs <- c(A = costA, B = costB, C = costC)
costs

names(costs)

names(costs) <- c("costA", "costB", "costC")
costs


## -----------------------------------------------------------------------------------------------------------------------------------------
costs[2]

costs["costB"]

costs[c(1, 3)] 

costs[c("costA", "costC")]



## -----------------------------------------------------------------------------------------------------------------------------------------
costs > 20

costs[costs > 20]

costs[costs != 25]


## -----------------------------------------------------------------------------------------------------------------------------------------
costs[1] <- 10
costs

costs[2:3] <- c(20, 30)
costs


## -----------------------------------------------------------------------------------------------------------------------------------------
costs + 100

exp(1:5)


## -----------------------------------------------------------------------------------------------------------------------------------------
costs + c(100, 200, 300)

costs * 1:3


## -----------------------------------------------------------------------------------------------------------------------------------------
costs * 1:2


## -----------------------------------------------------------------------------------------------------------------------------------------
paste("A", "B", "C")

paste("A", "B", "C", sep = ",")

paste0("A", "B", "C")               # Equivalent to sep = ""


## -----------------------------------------------------------------------------------------------------------------------------------------
abc <- c("a", "b", "c")
paste(abc)

paste("Letter", abc, sep = "-")

paste("Letter", abc, sep = "-", collapse = ", ")

paste(1:5, abc)


## -----------------------------------------------------------------------------------------------------------------------------------------
matrix(nrow = 2, ncol = 3)

matrix(1:6, nrow = 2, ncol = 3) # The vector 1:6 is the data argument


## -----------------------------------------------------------------------------------------------------------------------------------------
matrix(1:6, nrow = 2, ncol = 3, byrow = TRUE)


## -----------------------------------------------------------------------------------------------------------------------------------------
(m <- matrix(1:6, ncol = 3))


## -----------------------------------------------------------------------------------------------------------------------------------------
dim(m)

nrow(m)

ncol(m)


## -----------------------------------------------------------------------------------------------------------------------------------------
m[1, 2]          # First row, second column

m[2, 2:3]        # Second row, columns 2 and 3, and It is now a vector!

m[2, ] <- 10:12  # Replace second row
m


## -----------------------------------------------------------------------------------------------------------------------------------------
m[1, , drop = FALSE]   # First row but still a matrix

m[, 3, drop = FALSE]   # Third column but still a matrix

m[1, 2, drop = FALSE]  # A 1x1 matrix


## -----------------------------------------------------------------------------------------------------------------------------------------
colnames(m) <- c("A", "B", "C")
rownames(m) <- c("cost", "qaly")
m

colnames(m)

rownames(m)

m["qaly", ]


## -----------------------------------------------------------------------------------------------------------------------------------------
(m2 <- matrix(1:4, nrow = 2))

m2 + 100

exp(m2)


## ----error = TRUE-------------------------------------------------------------------------------------------------------------------------
try({
m2 + m2

(m3 <- matrix(1:6, ncol = 3))

m2 + m3
})


## ----error = TRUE-------------------------------------------------------------------------------------------------------------------------
try({
m2 * m2

m2 * m3
})


## ----error = TRUE-------------------------------------------------------------------------------------------------------------------------
try({
m2 %*% m2

m2 %*% m3

m3 %*% m2
})


## -----------------------------------------------------------------------------------------------------------------------------------------
t(m2)


## -----------------------------------------------------------------------------------------------------------------------------------------
m2_inverse <- solve(m2)
m2_inverse %*% m2


## ----error = TRUE-------------------------------------------------------------------------------------------------------------------------
try({
cbind(m2, m3)

rbind(m2, m2)
})


## -----------------------------------------------------------------------------------------------------------------------------------------
for (i in 1:3) {
  print(i)
}


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# output
# for (var in sequence) {
#   body
# }


## ----include = TRUE-----------------------------------------------------------------------------------------------------------------------
P <- matrix(c(0.75, 0, 0.25, 1), ncol = 2) # The transition matrix
P

# Matrix to store state occupancy at each of 4 cycles
state <- matrix(nrow = 4, ncol = 2) 
state[1, ] <- c(1, 0)  #  Initial state

for (i in 2:nrow(state)) {
  state[i, ] <- state[i - 1,] %*% P # Markov update
}

state


## ----random_samples-----------------------------------------------------------------------------------------------------------------------
x1 <- rnorm(n = 1000, mean = 0, sd = 1)
head(x1)

hist(x1)


## -----------------------------------------------------------------------------------------------------------------------------------------
set.seed(22032021)


## -----------------------------------------------------------------------------------------------------------------------------------------
rnorm(4)

rnorm(4)

set.seed(22032021)
rnorm(4)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# device(filename="myplot.png", options)
# plot code
# dev.off()


## ----eval = FALSE-------------------------------------------------------------------------------------------------------------------------
# png("./figures/logRR_histogram.png", width = 7, height = 5,
#     units = "in", res = 300)
# 
# hist(bl_risk, breaks = 50, freq = FALSE)
# curve(dbeta(x, 98, 402 - 98), add = TRUE, col = "darkred")
# 
# dev.off()


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# list(x1 = value1, x2 = value1, x3, x4)


## -----------------------------------------------------------------------------------------------------------------------------------------
l <- list(one = 1, "two", three = 3:6, list())


## -----------------------------------------------------------------------------------------------------------------------------------------
l[3]

l[c("one", "three")]

l[["three"]]

l$three


## -----------------------------------------------------------------------------------------------------------------------------------------
named_element <- "three"
l[[named_element]]




## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# data.frame(x1 = value1, x2 = value2, x3, x4)


## -----------------------------------------------------------------------------------------------------------------------------------------
id <- 1:4
x2 <- c(39, 45, 36, 52)
smoking <- data.frame(
  id,
  age = x2,
  smoke = c("Never", "Former", "Never", "Current"),
  outcome = c(FALSE, TRUE, TRUE, TRUE)
)
smoking


## -----------------------------------------------------------------------------------------------------------------------------------------
smoking[2:3, c("id", "age")]     # Rows 2-3, columns id and age


## -----------------------------------------------------------------------------------------------------------------------------------------
smoking[c("id", "age")]  # return a data frame, select multiple columns

smoking[["age"]]         # return a vector, can only select one column

smoking$age              # shortcut for `[[`


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# array(data = data, dim=dim, dimnames = dimnames)


## -----------------------------------------------------------------------------------------------------------------------------------------
array(
  dim = c(3, 2, 2),
  dimnames = list(
    cycle = NULL, treatment = c("A", "B"), state = c("Healthy", "Ill")
  )
)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# apply(X, MARGIN, FUN, ...)


## -----------------------------------------------------------------------------------------------------------------------------------------
m <- matrix(1:6, ncol = 3)
m

apply(m, 1, sum)

apply(m, 2, mean)


## -----------------------------------------------------------------------------------------------------------------------------------------
(m <- matrix(1:6, ncol = 2, dimnames = list(NULL, c("x1", "x2"))))

(df <- as.data.frame(m))

(l <- as.list(df))


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# object <- read.csv(file)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# write.csv(object, file=file)


## ----eval=FALSE---------------------------------------------------------------------------------------------------------------------------
# install.packages("readxl")
# install.packages("writexl")
# library(readxl)
# library(writexl)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# object <- read_excel(file, sheet = sheet, range = range)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# write_xlsx(object, file = file)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# saveRDS(object, file = file)
# object <- readRDS(file)


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# if (condition1) {
#   expression1
# } elseif {condition2} {
#   expression2
# } else {
#   expression3
# }


## -----------------------------------------------------------------------------------------------------------------------------------------
x <- 5
if (x > 1) {
  print("Greater than 1")
} else {
  print("Less than or equal to 1")
}


## -----------------------------------------------------------------------------------------------------------------------------------------
x <- 5
y <- 3
(x > 1) || (y > 4)


## -----------------------------------------------------------------------------------------------------------------------------------------
(x > 1) || (z > 0)  # || and && are lazy - z does not exist


## -----------------------------------------------------------------------------------------------------------------------------------------
#| echo: true
#| eval: false
# fn <- function(arguments) {
#   body
#   return(out)
# }


## -----------------------------------------------------------------------------------------------------------------------------------------
logit <- function(x) {
  return(log(x / (1 - x)))
}

logit(0.5)


## -----------------------------------------------------------------------------------------------------------------------------------------
net_benefit <- function(qaly, cost, threshold = 20000) {
  return(threshold * qaly - cost)
}

net_benefit(qaly = 0.8, cost = 1875)

net_benefit(0.8, 1875, threshold = 10000)


## -----------------------------------------------------------------------------------------------------------------------------------------
x <- 10

f <- function(value) {
  x <- value
  return(x)
}

f(5)

x


## ----eval = FALSE-------------------------------------------------------------------------------------------------------------------------
# if (threshold <= 0) {
#   stop("threshold must be positive")
# }

